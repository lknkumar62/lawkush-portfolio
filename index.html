<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Lawkush Portfolio Firebase</title>

  <style>
    body {
      background: black;
      color: white;
      font-family: Arial;
      text-align: center;
    }
    button {
      padding: 10px 20px;
      margin: 5px;
      cursor: pointer;
      border: none;
      border-radius: 8px;
    }
    .box {
      border: 2px solid cyan;
      padding: 20px;
      margin: 20px auto;
      width: 350px;
      border-radius: 15px;
    }
    input {
      padding: 10px;
      width: 90%;
      margin: 5px;
      border-radius: 8px;
      border: none;
    }
  </style>
</head>

<body>

  <h1 id="heroName">Loading...</h1>
  <p id="heroTagline"></p>
  <img id="heroImage" width="180" style="border-radius:50%;">

  <hr>

  <!-- USER LOGIN -->
  <div class="box">
    <h2>üë§ User Login</h2>

    <input id="userEmail" placeholder="Email">
    <input id="userPass" type="password" placeholder="Password">

    <button onclick="emailLogin()">Login</button>
    <button onclick="emailSignup()">Signup</button>

    <br><br>
    <button onclick="googleLogin()">Login with Google</button>

    <p id="userStatus"></p>
    <button onclick="logout()">Logout</button>
  </div>

  <!-- ADMIN PANEL -->
  <div id="adminPanel" class="box" style="display:none;">
    <h2>üîê Admin Dashboard</h2>

    <input id="editName" placeholder="Hero Name">
    <input id="editTag" placeholder="Hero Tagline">

    <button onclick="updateProfile()">Save Profile</button>
  </div>


<script type="module">
  // Firebase Imports
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

  import {
    getAuth,
    GoogleAuthProvider,
    signInWithPopup,
    signInWithEmailAndPassword,
    createUserWithEmailAndPassword,
    signOut,
    onAuthStateChanged
  } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

  // ‚úÖ Your Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyBgjSRBDfaL0FAb7_Tjb3vKpBw1qqevDyw",
    authDomain: "lawkush-portfolio.firebaseapp.com",
    projectId: "lawkush-portfolio",
    storageBucket: "lawkush-portfolio.firebasestorage.app",
    messagingSenderId: "682826833656",
    appId: "1:682826833656:web:c500f3637e88cf0e89e50d"
  };

  // Init Firebase
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const auth = getAuth(app);

  // ‚úÖ ADMIN UID (Only you can edit)
  const ADMIN_UID = "NeFVRM4IBJes38S6vHcL632GHKh2";

  let siteData = null;

  // Default Website Data
  const defaultData = {
    profile: {
      image: "./profile.png",
      name: "Lawkush Kumar",
      tagline: "Creative Developer & Digital Creator"
    }
  };

  // Load Website Data
  async function loadWebsite() {
    const ref = doc(db, "portfolio", "site");
    const snap = await getDoc(ref);

    if (snap.exists()) {
      siteData = snap.data();
    } else {
      siteData = defaultData;
      await setDoc(ref, defaultData);
    }
    renderSite();
  }

  // Render
  function renderSite() {
    document.getElementById("heroImage").src = siteData.profile.image;
    document.getElementById("heroName").innerText = siteData.profile.name;
    document.getElementById("heroTagline").innerText = siteData.profile.tagline;
  }

  // Save Profile
  async function saveWebsite() {
    const ref = doc(db, "portfolio", "site");
    await setDoc(ref, siteData);
    alert("‚úÖ Saved Permanently!");
    renderSite();
  }

  // Update Profile
  window.updateProfile = function () {
    siteData.profile.name = document.getElementById("editName").value;
    siteData.profile.tagline = document.getElementById("editTag").value;
    saveWebsite();
  };

  // USER LOGIN FUNCTIONS
  window.googleLogin = async function () {
    const provider = new GoogleAuthProvider();
    await signInWithPopup(auth, provider);
  };

  window.emailLogin = async function () {
    const email = document.getElementById("userEmail").value;
    const pass = document.getElementById("userPass").value;
    await signInWithEmailAndPassword(auth, email, pass);
  };

  window.emailSignup = async function () {
    const email = document.getElementById("userEmail").value;
    const pass = document.getElementById("userPass").value;
    await createUserWithEmailAndPassword(auth, email, pass);
  };

  window.logout = async function () {
    await signOut(auth);
  };

  // Auth Listener
  onAuthStateChanged(auth, (user) => {
    if (user) {
      document.getElementById("userStatus").innerText =
        "Logged in as: " + user.email;

      // Admin Access
      if (user.uid === ADMIN_UID) {
        document.getElementById("adminPanel").style.display = "block";
      } else {
        document.getElementById("adminPanel").style.display = "none";
      }

    } else {
      document.getElementById("userStatus").innerText = "Not logged in";
      document.getElementById("adminPanel").style.display = "none";
    }
  });

  loadWebsite();

</script>

</body>
</html>
